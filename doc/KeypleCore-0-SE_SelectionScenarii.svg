<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1004px" preserveAspectRatio="none" style="width:516px;height:1004px;" version="1.1" viewBox="0 0 516 1004" width="516px" zoomAndPan="magnify"><defs><filter height="300%" id="f14o097qvlvww2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="227.75" cy="20" fill="#000000" filter="url(#f14o097qvlvww2)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FFFFFF" filter="url(#f14o097qvlvww2)" height="190.2031" style="stroke: #000000; stroke-width: 2.0;" width="224" x="115.75" y="40.8018"/><path d="M258.75,41.8018 L258.75,50.0986 L248.75,60.0986 L115.75,60.0986 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="133" x="118.75" y="54.7969">Reader initialization</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="111" x="172.25" y="77.0986"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="182.25" y="98.2373">register plugin</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="107" x="174.25" y="131.0674"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="184.25" y="152.2061">get SE reader</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="125.75" y="185.0361"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="184" x="135.75" y="206.1748">prepare SE selection request</text><polygon fill="#FEFECE" filter="url(#f14o097qvlvww2)" points="174.75,251.0049,280.75,251.0049,292.75,263.0049,280.75,275.0049,174.75,275.0049,162.75,263.0049,174.75,251.0049" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="174.75" y="266.813">transaction mode?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="68.75" y="260.4106">explicit selection</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="292.75" y="260.4106">default selection</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="35" y="285.0049"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="45" y="306.1436">test SE presence</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="178" x="10" y="353.9736"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="158" x="20" y="375.1123">process explicit selection</text><rect fill="#FFFFFF" filter="url(#f14o097qvlvww2)" height="205.2031" style="stroke: #000000; stroke-width: 2.0;" width="269" x="222" y="285.0049"/><path d="M481,286.0049 L481,294.3018 L471,304.3018 L222,304.3018 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="249" x="225" y="299">Observer: observable reader setting</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="219" x="247" y="321.3018"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="199" x="257" y="342.4404">default selection reader setting</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="217" x="248" y="390.2705"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="197" x="258" y="411.4092">reader notification subscribtion</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="287" y="444.2393"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="297" y="465.3779">"wait SE detection"</text><rect fill="#000000" filter="url(#f14o097qvlvww2)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="242" x="235.5" y="500.208"/><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="282" y="526.208"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="129" x="292" y="547.3467">polling SE presence)</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="309" y="570.1768"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="319" y="591.3154">SE insertion</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="267" y="624.1455"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="159" x="277" y="645.2842">process default selection</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="214" x="249.5" y="678.1143"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="194" x="259.5" y="699.2529">notifies SE inserted &amp; selected</text><rect fill="#000000" filter="url(#f14o097qvlvww2)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="242" x="235.5" y="722.083"/><rect fill="#FFFFFF" filter="url(#f14o097qvlvww2)" height="82.2656" style="stroke: #000000; stroke-width: 2.0;" width="297" x="208" y="738.8848"/><path d="M495,739.8848 L495,748.1816 L485,758.1816 L208,758.1816 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="277" x="211" y="752.8799">Observer: reader notification processing</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="194" x="259.5" y="775.1816"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="174" x="269.5" y="796.3203">process selection response</text><polygon fill="#FEFECE" filter="url(#f14o097qvlvww2)" points="227.75,827.1504,239.75,839.1504,227.75,851.1504,215.75,839.1504,227.75,827.1504" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="168.25" y="871.1504"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="99" x="178.25" y="892.2891">get selected SE</text><rect fill="#FEFECE" filter="url(#f14o097qvlvww2)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="116.25" y="959.3228"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="203" x="126.25" y="980.4614">send APDU commands to the SE</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="227.75" x2="227.75" y1="111.0674" y2="131.0674"/><polygon fill="#A80036" points="223.75,121.0674,227.75,131.0674,231.75,121.0674,227.75,125.0674" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="227.75" x2="227.75" y1="165.0361" y2="185.0361"/><polygon fill="#A80036" points="223.75,175.0361,227.75,185.0361,231.75,175.0361,227.75,179.0361" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="227.75" x2="227.75" y1="30" y2="77.0986"/><polygon fill="#A80036" points="223.75,67.0986,227.75,77.0986,231.75,67.0986,227.75,71.0986" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="99" x2="99" y1="318.9736" y2="353.9736"/><polygon fill="#A80036" points="95,343.9736,99,353.9736,103,343.9736,99,347.9736" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="356.5" y1="355.2705" y2="390.2705"/><polygon fill="#A80036" points="352.5,380.2705,356.5,390.2705,360.5,380.2705,356.5,384.2705" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="356.5" y1="424.2393" y2="444.2393"/><polygon fill="#A80036" points="352.5,434.2393,356.5,444.2393,360.5,434.2393,356.5,438.2393" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="356.5" y1="604.1455" y2="624.1455"/><polygon fill="#A80036" points="352.5,614.1455,356.5,624.1455,360.5,614.1455,356.5,618.1455" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="356.5" y1="658.1143" y2="678.1143"/><polygon fill="#A80036" points="352.5,668.1143,356.5,678.1143,360.5,668.1143,356.5,672.1143" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="356.5" y1="506.208" y2="526.208"/><polygon fill="#A80036" points="352.5,516.208,356.5,526.208,360.5,516.208,356.5,520.208" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="356.5" y1="728.083" y2="775.1816"/><polygon fill="#A80036" points="352.5,765.1816,356.5,775.1816,360.5,765.1816,356.5,769.1816" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="162.75" x2="99" y1="263.0049" y2="263.0049"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="99" x2="99" y1="263.0049" y2="285.0049"/><polygon fill="#A80036" points="95,275.0049,99,285.0049,103,275.0049,99,279.0049" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="292.75" x2="356.5" y1="263.0049" y2="263.0049"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="356.5" y1="263.0049" y2="321.3018"/><polygon fill="#A80036" points="352.5,311.3018,356.5,321.3018,360.5,311.3018,356.5,315.3018" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="99" x2="99" y1="387.9424" y2="839.1504"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="99" x2="215.75" y1="839.1504" y2="839.1504"/><polygon fill="#A80036" points="205.75,835.1504,215.75,839.1504,205.75,843.1504,209.75,839.1504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="356.5" y1="809.1504" y2="839.1504"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="356.5" x2="239.75" y1="839.1504" y2="839.1504"/><polygon fill="#A80036" points="249.75,835.1504,239.75,839.1504,249.75,843.1504,245.75,839.1504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="227.75" x2="227.75" y1="219.0049" y2="251.0049"/><polygon fill="#A80036" points="223.75,241.0049,227.75,251.0049,231.75,241.0049,227.75,245.0049" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="227.75" x2="227.75" y1="851.1504" y2="871.1504"/><polygon fill="#A80036" points="223.75,861.1504,227.75,871.1504,231.75,861.1504,227.75,865.1504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.5; stroke-dasharray: 7.0,7.0;" x1="227.75" x2="227.75" y1="905.1191" y2="959.3228"/><polygon fill="#008000" points="223.75,949.3228,227.75,959.3228,231.75,949.3228,227.75,953.3228" style="stroke: #008000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="174" x="231.75" y="926.4238">Then specific operations could</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="239.75" y="939.2285">be processed with the SE...</text><!--MD5=[1759ee7e53a6a4e4d9855625a8457857]
@startuml
start
partition "Reader initialization" {
	:register plugin;
	:get SE reader;
	:prepare SE selection request;
}

if (transaction mode?) then (explicit selection)
	:test SE presence;
	:process explicit selection;
else (default selection)
	partition "Observer: observable reader setting" {
	:default selection reader setting;
	:reader notification subscribtion;
	:"wait SE detection";
	}
	detach
	fork
		:polling SE presence);
		detach
		:SE insertion;
		:process default selection;
		:notifies SE inserted & selected;
	end fork
	detach
	partition "Observer: reader notification processing" {
		:process selection response;
	}
endif
	:get selected SE;
-[#green,dashed]-> Then specific operations could
  be processed with the SE...;
	:send APDU commands to the SE;
@enduml

PlantUML version 1.2019.13(Tue Dec 10 17:18:29 UTC 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>